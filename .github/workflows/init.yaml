name: Initialize Template

on:
  push:
    branches: ["master"]

jobs:
  build:
    if: github.repository != 'TBlauwe/cpp_lib_starter'

    runs-on: ubuntu-latest

    permissions:
      # Give the default GITHUB_TOKEN write permission to commit and push the
      # added or changed files to the repository.
      contents: write

    steps:
      - uses: actions/checkout@v2
      
      - name: Apply template
        run: npx tmplr
        env:
          owner_name: ${{ github.event.repository.owner.name }}
          owner_email: ${{ github.event.repository.owner.email }}
          repo_name: ${{ github.event.repository.name }}
          repo_url: ${{ github.event.repository.ssh_url }}
          repo_desc: ${{ github.event.repository.description }}

      - uses: stefanzweifel/git-auto-commit-action@v5
        with:
            commit_message: "Generate project from template"